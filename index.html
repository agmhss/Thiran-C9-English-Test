<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Thiran English Class 9 ‚Äì 10 Marks Test</title>
<style>
  :root{--bg1:#f0f7ff;--card:#fff;--accent:#2b6cb0;--ok:#16a34a;--bad:#dc2626}
  html,body{height:100%;margin:0;font-family:Inter,Arial,sans-serif;background:linear-gradient(180deg,var(--bg1),#e6f0ff);display:flex;align-items:center;justify-content:center;padding:12px}
  .wrap{width:100%;max-width:760px;background:var(--card);border-radius:14px;box-shadow:0 10px 30px rgba(20,30,60,.12);padding:18px}
  header{display:flex;align-items:center;gap:12px;margin-bottom:10px;flex-wrap:wrap}
  header h1{margin:0;font-size:1.2rem;color:var(--accent)}
  .meta{margin-left:auto;text-align:right;font-size:.9rem}
  .score{font-weight:700;color:#0b6;display:block;font-size:1.4rem}
  .card{padding:14px;border-radius:10px;border:1px solid #eef5ff;background:linear-gradient(180deg,#fff,#fbfdff);margin-bottom:12px}
  .sentence{font-size:1.05rem;padding:12px;border-radius:8px;background:#f7fbff;border:1px dashed #dfeeff;min-height:56px;display:flex;align-items:center}
  .options{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:12px}
  .opt{padding:10px;border-radius:8px;border:1px solid #e6eefc;background:white;cursor:pointer;user-select:none}
  .opt.selected{outline:3px solid rgba(43,108,176,.12)}
  .opt.correct{border-color:var(--ok);background:rgba(16,185,129,.06)}
  .opt.wrong{border-color:var(--bad);background:rgba(220,38,38,.04)}
  .controls{display:flex;gap:8px;align-items:center;margin-top:12px;flex-wrap:wrap}
  button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
  .btn-ghost{background:#fff;border:1px solid #dbeefe;color:var(--accent)}
  .progress{height:8px;background:#eef6ff;border-radius:8px;margin-top:8px;overflow:hidden}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg,#2b6cb0,#4f9ae6);width:0%}
  .feedback{margin-top:8px;font-weight:700;min-height:22px}
  .timer{font-weight:700;padding:6px 10px;border-radius:8px;background:#f1f7ff;border:1px solid #dbeefe;margin-left:auto}
  @media(max-width:620px){
    .options{grid-template-columns:1fr}
    header{gap:8px}
  }
</style>
</head>
<body>
  <div class="wrap" role="application" aria-label="Thiran English Class 9 - 10 Marks Test">
    <header>
      <div>
        <h1>Gtk Thiran English Class 9 ‚Äì 10 Marks Test</h1>
        <div style="font-size:.88rem;color:#556">10 fixed questions ‚Äî one after another ‚Äî 30s timer per question</div>
      </div>
      <div class="meta" aria-live="polite">
        <div>Score: <span id="currentScore" class="score">0</span></div>
      </div>
    </header>

    <div class="card" id="questionCard" aria-live="polite">
      <div class="sentence" id="sentence">Press <strong>Start Game</strong> to begin the 10 marks test.</div>

      <div class="options" id="options" aria-hidden="true"></div>

      <div class="controls">
        <button id="submitBtn" disabled>Submit Answer</button>
        <button id="skipBtn" class="btn-ghost" disabled>Skip</button>
        <button id="nextBtn" class="btn-ghost" style="display:none">Next</button>
        <div class="timer" id="timer">‚è≥ 30s</div>
        <div style="font-size:.9rem;color:#667">Q <span id="qIndex">0</span>/<span id="qTotal">10</span></div>
      </div>

      <div class="progress" aria-hidden="true"><i id="progressBar"></i></div>
      <div class="feedback" id="feedback" aria-live="polite"></div>
    </div>

    <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:10px">
      <button id="startBtn">Start Game</button>
      <button id="restartBtn" class="btn-ghost" style="display:none">Restart</button>
    </div>

    <!-- Download PDF -->
    <button id="downloadPdfBtn" style="
      display:none;
      background:#2b6cb0;
      color:white;
      border:none;
      padding:10px 20px;
      border-radius:8px;
      font-size:16px;
      cursor:pointer;
      margin-top:20px;
    ">
      üìÑ Download My Answers (PDF)
    </button>
  </div>

  <!-- Load jsPDF from CDN -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script>
    /* ============================
       FULL QUESTION BANK (exact copy)
       ============================ */
    const bank = [
      // --- Verb Tense ---
      { sentence: "Choose correct: 'We ____ this movie before.'", chapter:"Verb Tense", options:["have seen","saw","see","am seeing"], answerText:"have seen", explanation:"Present perfect for experience." },
      { sentence: "Choose correct: 'I ____ my homework when the power went off.'", chapter:"Verb Tense", options:["was doing","did","am doing","had done"], answerText:"was doing", explanation:"Past continuous interrupted by another past action." },
      { sentence: "Choose correct: 'She ____ here since 2015.'", chapter:"Verb Tense", options:["has worked","worked","works","is working"], answerText:"has worked", explanation:"'since' ‚Üí present perfect tense." },
      { sentence: "Choose correct: 'By the time we arrived, the bus ____.'", chapter:"Verb Tense", options:["had left","left","leaves","was leaving"], answerText:"had left", explanation:"Past perfect before another past action." },
      { sentence: "Choose correct: 'I ____ breakfast at 8 every day.'", chapter:"Verb Tense", options:["eat","ate","am eating","have eaten"], answerText:"eat", explanation:"Habitual action ‚Üí simple present." },
      { sentence: "Choose correct: 'They ____ to Delhi last summer.'", chapter:"Verb Tense", options:["went","go","have gone","are going"], answerText:"went", explanation:"Completed action in the past ‚Üí simple past." },
      { sentence: "Choose correct: 'He ____ to school right now.'", chapter:"Verb Tense", options:["is going","goes","went","has gone"], answerText:"is going", explanation:"Current action ‚Üí present continuous." },
      { sentence: "Choose correct: 'We ____ dinner when the guests arrived.'", chapter:"Verb Tense", options:["were having","had","have","are having"], answerText:"were having", explanation:"Past continuous when another past action happened." },
      { sentence: "Choose correct: 'She ____ her keys yesterday.'", chapter:"Verb Tense", options:["lost","has lost","loses","was losing"], answerText:"lost", explanation:"Yesterday ‚Üí simple past." },
      { sentence: "Choose correct: 'By next month, we ____ the project.'", chapter:"Verb Tense", options:["will have finished","finished","finish","had finished"], answerText:"will have finished", explanation:"Future perfect tense." },
      { sentence: "Choose correct: 'He ____ English for five years.'", chapter:"Verb Tense", options:["has studied","studied","studies","is studying"], answerText:"has studied", explanation:"Duration ‚Üí present perfect tense." },

      // --- Prepositions ---
      { sentence: "Choose the correct word: 'He is afraid ___ snakes.'", chapter:"Prepositions", options:["of","from","by","about"], answerText:"of", explanation:"'afraid of'." },
      { sentence: "Choose the correct: 'She is good ___ painting.'", chapter:"Prepositions", options:["at","on","in","for"], answerText:"at", explanation:"'good at'." },
      { sentence: "Choose the correct: 'He sat ___ the chair.'", chapter:"Prepositions", options:["on","in","at","over"], answerText:"on", explanation:"Sit on a chair." },
      { sentence: "Choose the correct: 'The cat jumped ___ the wall.'", chapter:"Prepositions", options:["over","on","in","through"], answerText:"over", explanation:"Jumped over ‚Üí across from one side to another." },
      { sentence: "Choose the correct: 'The shop is ___ the corner.'", chapter:"Prepositions", options:["at","on","in","by"], answerText:"at", explanation:"'at the corner' is correct." },
      { sentence: "Choose the correct: 'He divided the cake ___ four parts.'", chapter:"Prepositions", options:["into","in","at","to"], answerText:"into", explanation:"Divide into parts." },
      { sentence: "Choose the correct: 'The boy ran ___ the field.'", chapter:"Prepositions", options:["across","through","in","on"], answerText:"across", explanation:"'across the field' ‚Üí from one side to another." },
      { sentence: "Choose the correct: 'The picture is ___ the wall.'", chapter:"Prepositions", options:["on","over","above","in"], answerText:"on", explanation:"'on the wall' ‚Üí contact surface." },
      { sentence: "Choose the correct: 'He comes ___ a small village.'", chapter:"Prepositions", options:["from","of","at","in"], answerText:"from", explanation:"Origin ‚Üí 'from'." },
      { sentence: "Choose the correct: 'She was born ___ April.'", chapter:"Prepositions", options:["in","on","at","during"], answerText:"in", explanation:"Months ‚Üí 'in'." },
      { sentence: "Choose the correct: 'Meet me ___ the bus stop.'", chapter:"Prepositions", options:["at","on","in","over"], answerText:"at", explanation:"Fixed point ‚Üí 'at'." },

      // --- Subject-Verb Agreement ---
      { sentence: "Identify the correction: 'They has finished their homework.' ‚Üí", chapter:"Subject-Verb Agreement", options:["They have finished their homework.","They has finished their homework.","They had finished their homework.","They finishing their homework."], answerText:"They have finished their homework.", explanation:"'They' takes 'have'." },
      { sentence: "Choose correct: 'She ___ to school every day.'", chapter:"Subject-Verb Agreement", options:["goes","go","going","gone"], answerText:"goes", explanation:"Singular subject ‚Üí 'goes'." },
      { sentence: "Choose correct: 'My friends ___ playing football now.'", chapter:"Subject-Verb Agreement", options:["are","is","was","be"], answerText:"are", explanation:"Plural subject ‚Üí 'are'." },
      { sentence: "Choose correct: 'The list of items ___ on the table.'", chapter:"Subject-Verb Agreement", options:["is","are","were","be"], answerText:"is", explanation:"Main subject is 'list' (singular)." },
      { sentence: "Choose correct: 'Neither of them ___ present today.'", chapter:"Subject-Verb Agreement", options:["is","are","were","be"], answerText:"is", explanation:"'Neither' is singular." },
      { sentence: "Choose correct: 'Each student ___ a notebook.'", chapter:"Subject-Verb Agreement", options:["has","have","having","had"], answerText:"has", explanation:"'Each' ‚Üí singular." },
      { sentence: "Choose correct: 'The players ___ tired after the match.'", chapter:"Subject-Verb Agreement", options:["were","was","is","be"], answerText:"were", explanation:"Plural ‚Üí 'were'." },
      { sentence: "Choose correct: 'Mathematics ___ an interesting subject.'", chapter:"Subject-Verb Agreement", options:["is","are","were","be"], answerText:"is", explanation:"'Mathematics' ‚Üí singular meaning." },
      { sentence: "Choose correct: 'My brother and sister ___ coming home.'", chapter:"Subject-Verb Agreement", options:["are","is","was","has"], answerText:"are", explanation:"Compound subject ‚Üí plural verb." },
      { sentence: "Choose correct: 'The news ___ on TV every night.'", chapter:"Subject-Verb Agreement", options:["is","are","were","been"], answerText:"is", explanation:"'News' is singular in form." },
      { sentence: "Choose correct: 'Everyone ___ happy today.'", chapter:"Subject-Verb Agreement", options:["is","are","were","be"], answerText:"is", explanation:"'Everyone' ‚Üí singular." },

      // --- Framing Questions ---
{ sentence: "Frame a question for the *italicised words*: He bought a car *yesterday*.", chapter: "Framing Questions", options: ["When did he buy a car?", "What did he buy yesterday?", "Who bought a car yesterday?", "Where did he buy a car?"], answerText: "When did he buy a car?", explanation: "'Yesterday' refers to time ‚Üí use 'When'." },

{ sentence: "Frame a question for the *italicised words*: *Ravi* is going to school.", chapter: "Framing Questions", options: ["Who is going to school?", "Where is Ravi going?", "What is Ravi doing?", "When is Ravi going to school?"], answerText: "Who is going to school?", explanation: "Subject is highlighted ‚Üí 'Who' question." },

{ sentence: "Frame a question for the *italicised words*: She met her friend *at the park*.", chapter: "Framing Questions", options: ["Where did she meet her friend?", "When did she meet her friend?", "Who did she meet?", "Why did she meet her friend?"], answerText: "Where did she meet her friend?", explanation: "'At the park' ‚Üí place ‚Üí 'Where'." },

{ sentence: "Frame a question for the *italicised words*: He is eating *an apple*.", chapter: "Framing Questions", options: ["What is he eating?", "Who is eating an apple?", "Where is he eating?", "When is he eating?"], answerText: "What is he eating?", explanation: "'An apple' ‚Üí object ‚Üí 'What'." },

{ sentence: "Frame a question for the *italicised words*: They go to church *on Sundays*.", chapter: "Framing Questions", options: ["When do they go to church?", "Where do they go on Sundays?", "Why do they go to church?", "Who goes to church?"], answerText: "When do they go to church?", explanation: "'On Sundays' ‚Üí time ‚Üí 'When'." },

{ sentence: "Frame a question for the *italicised words*: She writes neatly *with a blue pen*.", chapter: "Framing Questions", options: ["With what does she write neatly?", "Why does she write neatly?", "When does she write neatly?", "Who writes neatly?"], answerText: "With what does she write neatly?", explanation: "'With a blue pen' ‚Üí instrument ‚Üí 'With what'." },

{ sentence: "Frame a question for the *italicised words*: *My brother* helped me with my homework.", chapter: "Framing Questions", options: ["Who helped you with your homework?", "What did your brother help you with?", "When did he help you?", "Where did he help you?"], answerText: "Who helped you with your homework?", explanation: "Subject ‚Üí 'Who'." },

{ sentence: "Frame a question for the *italicised words*: She spoke to *the headmaster*.", chapter: "Framing Questions", options: ["Whom did she speak to?", "Who spoke to the headmaster?", "When did she speak to the headmaster?", "Where did she speak?"], answerText: "Whom did she speak to?", explanation: "Object (person) ‚Üí 'Whom'." },

{ sentence: "Frame a question for the *italicised words*: He was absent *because he was ill*.", chapter: "Framing Questions", options: ["Why was he absent?", "When was he absent?", "Where was he absent?", "Who was absent?"], answerText: "Why was he absent?", explanation: "'Because he was ill' ‚Üí reason ‚Üí 'Why'." },

{ sentence: "Frame a question for the *italicised words*: The train arrived *at 7 o‚Äôclock*.", chapter: "Framing Questions", options: ["When did the train arrive?", "Where did the train arrive?", "Why did the train arrive?", "Who arrived at 7 o‚Äôclock?"], answerText: "When did the train arrive?", explanation: "Time phrase ‚Üí 'When'." },


      // --- Voice ---
      { sentence: "Passive of 'She cooks food every day.'", chapter:"Voice", options:["Food is cooked by her every day.","Food was cooked by her every day.","Food will be cooked by her every day.","Food has been cooked by her every day."], answerText:"Food is cooked by her every day.", explanation:"Simple present passive." },
      { sentence: "Passive of 'He wrote a letter.'", chapter:"Voice", options:["A letter was written by him.","A letter is written by him.","A letter will be written by him.","A letter has written by him."], answerText:"A letter was written by him.", explanation:"Simple past passive." },
      { sentence: "Passive of 'They are watching a movie.'", chapter:"Voice", options:["A movie is being watched by them.","A movie was watched by them.","A movie has been watched by them.","A movie watches by them."], answerText:"A movie is being watched by them.", explanation:"Present continuous passive." },
      { sentence: "Passive of 'He will deliver the parcel tomorrow.'", chapter:"Voice", options:["The parcel will be delivered by him tomorrow.","The parcel is delivered by him tomorrow.","The parcel has been delivered by him tomorrow.","The parcel delivers by him tomorrow."], answerText:"The parcel will be delivered by him tomorrow.", explanation:"Future passive form." },
      { sentence: "Passive of 'She has painted a picture.'", chapter:"Voice", options:["A picture has been painted by her.","A picture was painted by her.","A picture is painted by her.","A picture paints by her."], answerText:"A picture has been painted by her.", explanation:"Present perfect passive." },
      { sentence: "Passive of 'They built a bridge.'", chapter:"Voice", options:["A bridge was built by them.","A bridge has built by them.","A bridge is built by them.","A bridge builds by them."], answerText:"A bridge was built by them.", explanation:"Past passive." },
      { sentence: "Passive of 'She is reading a novel.'", chapter:"Voice", options:["A novel is being read by her.","A novel was read by her.","A novel reads by her.","A novel has been read by her."], answerText:"A novel is being read by her.", explanation:"Present continuous passive." },
      { sentence: "Passive of 'They will announce the result soon.'", chapter:"Voice", options:["The result will be announced soon.","The result is announced soon.","The result has been announced soon.","The result was announced soon."], answerText:"The result will be announced soon.", explanation:"Future passive." },
      { sentence: "Passive of 'The teacher punished the boy.'", chapter:"Voice", options:["The boy was punished by the teacher.","The boy is punished by the teacher.","The boy has punished by the teacher.","The boy punishes by the teacher."], answerText:"The boy was punished by the teacher.", explanation:"Past passive." },
      { sentence: "Passive of 'He can solve the problem.'", chapter:"Voice", options:["The problem can be solved by him.","The problem was solved by him.","The problem is solved by him.","The problem can solved by him."], answerText:"The problem can be solved by him.", explanation:"Modal + be + past participle." },
      { sentence: "Passive of 'They are repairing the road.'", chapter:"Voice", options:["The road is being repaired by them.","The road was repaired by them.","The road repairs by them.","The road has repaired by them."], answerText:"The road is being repaired by them.", explanation:"Present continuous passive." },

      // --- Reported Speech ---
      { sentence: "Direct: Rani said, 'We visited the museum yesterday.' Reported:", chapter:"Reported Speech", options:["Rani said they had visited the museum the day before.","Rani said we visited the museum yesterday.","Rani says we visited the museum yesterday.","Rani said they will visit the museum."], answerText:"Rani said they had visited the museum the day before.", explanation:"Backshift and time-word change required." },
      { sentence: "Direct: He said, 'I am tired.' Reported:", chapter:"Reported Speech", options:["He said he was tired.","He said I was tired.","He said he is tired.","He said he tired."], answerText:"He said he was tired.", explanation:"Present ‚Üí past." },
      { sentence: "Direct: She said, 'I will call you tomorrow.' Reported:", chapter:"Reported Speech", options:["She said she would call me the next day.","She said she will call me tomorrow.","She said I would call her the next day.","She says she will call me tomorrow."], answerText:"She said she would call me the next day.", explanation:"'will' ‚Üí 'would' and time change." },
      { sentence: "Direct: He said, 'I have finished my work.' Reported:", chapter:"Reported Speech", options:["He said he had finished his work.","He said he has finished his work.","He said I finished my work.","He says he finished his work."], answerText:"He said he had finished his work.", explanation:"Present perfect ‚Üí past perfect." },
      { sentence: "Direct: The teacher said, 'Be quiet!'", chapter:"Reported Speech", options:["The teacher told us to be quiet.","The teacher said us to be quiet.","The teacher asked us be quiet.","The teacher say to be quiet."], answerText:"The teacher told us to be quiet.", explanation:"Imperative ‚Üí told + to-infinitive." },
      { sentence: "Direct: He said to me, 'Do you like music?'", chapter:"Reported Speech", options:["He asked me if I liked music.","He asked me did I like music.","He asked me that I like music.","He said I liked music."], answerText:"He asked me if I liked music.", explanation:"Question ‚Üí 'asked if' + clause." },
      { sentence: "Direct: She said, 'I can swim well.' Reported:", chapter:"Reported Speech", options:["She said she could swim well.","She said she can swim well.","She told she could swim well.","She said she was able swim well."], answerText:"She said she could swim well.", explanation:"Modal 'can' ‚Üí 'could'." },
      { sentence: "Direct: Raju said, 'I am reading now.' Reported:", chapter:"Reported Speech", options:["Raju said he was reading then.","Raju said he is reading now.","Raju told he was reading.","Raju said he has been reading."], answerText:"Raju said he was reading then.", explanation:"Present continuous ‚Üí past continuous; 'now' ‚Üí 'then'." },
      { sentence: "Direct: She said, 'I bought a new dress yesterday.' Reported:", chapter:"Reported Speech", options:["She said she had bought a new dress the previous day.","She said she has bought a new dress yesterday.","She said she bought a new dress the previous day.","She said I had bought a new dress."], answerText:"She said she had bought a new dress the previous day.", explanation:"Past ‚Üí past perfect; 'yesterday' ‚Üí 'the previous day'." },
      { sentence: "Direct: He said, 'It is raining heavily.' Reported:", chapter:"Reported Speech", options:["He said it was raining heavily.","He said it is raining heavily.","He told it was raining heavily.","He said it has been raining heavily."], answerText:"He said it was raining heavily.", explanation:"Present ‚Üí past." },
      { sentence: "Direct: The doctor said, 'Take this medicine twice a day.'", chapter:"Reported Speech", options:["The doctor advised me to take that medicine twice a day.","The doctor said me take this medicine twice a day.","The doctor told to take this medicine twice a day.","The doctor said take medicine twice a day."], answerText:"The doctor advised me to take that medicine twice a day.", explanation:"Advice ‚Üí 'advised to'." },
      { sentence: "Direct: Father said, 'Don‚Äôt waste your time.'", chapter:"Reported Speech", options:["Father told me not to waste my time.","Father said me not waste my time.","Father said me to not waste my time.","Father told me do not waste time."], answerText:"Father told me not to waste my time.", explanation:"Negative imperative ‚Üí 'told ... not to'." },
      { sentence: "Direct: He said, 'I may come tomorrow.' Reported:", chapter:"Reported Speech", options:["He said he might come the next day.","He said he may come tomorrow.","He told he might come the next day.","He said he will come next day."], answerText:"He said he might come the next day.", explanation:"Modal 'may' ‚Üí 'might' and time change." },
      { sentence: "Direct: She said, 'I must go now.' Reported:", chapter:"Reported Speech", options:["She said she had to go then.","She said she must go now.","She told she must go then.","She said she would go now."], answerText:"She said she had to go then.", explanation:"'must' often ‚Üí 'had to' in reported speech." },

      // --- Types of Sentences (and a few extras at the end of your file) ---
      { sentence: "Which of the following is an interrogative sentence?", chapter:"Types of Sentences", options:["Have you lost your money?","I am reading a newspaper.","What a tall building it is!","Keep off the grass."], answerText:"Have you lost your money?", explanation:"Interrogative asks a question." },
      { sentence: "Which of the following is a declarative sentence?", chapter:"Types of Sentences", options:["The sun rises in the east.","What a beautiful view!","Please open the door.","Where are you going?"], answerText:"The sun rises in the east.", explanation:"Declarative states a fact." },
      { sentence: "Which of the following is an exclamatory sentence?", chapter:"Types of Sentences", options:["What a lovely day it is!","Close the window.","Are you coming?","She is reading."], answerText:"What a lovely day it is!", explanation:"Exclamatory expresses strong feeling." },
      { sentence: "Which of the following is an imperative sentence?", chapter:"Types of Sentences", options:["Please sit down.","He is sitting.","Where is he?","What a sit!"], answerText:"Please sit down.", explanation:"Imperative gives command/request." },
      { sentence: "Identify the sentence type: 'Don‚Äôt touch that wire!'", chapter:"Types of Sentences", options:["Imperative","Interrogative","Declarative","Exclamatory"], answerText:"Imperative", explanation:"Command or warning." },
      { sentence: "Identify the sentence type: 'How fast the train is moving!'", chapter:"Types of Sentences", options:["Exclamatory","Interrogative","Declarative","Imperative"], answerText:"Exclamatory", explanation:"Expresses surprise." },
      { sentence: "Identify the sentence type: 'Who is knocking at the door?'", chapter:"Types of Sentences", options:["Interrogative","Declarative","Imperative","Exclamatory"], answerText:"Interrogative", explanation:"Asks a question." },
      { sentence: "Identify the sentence type: 'The stars shine at night.'", chapter:"Types of Sentences", options:["Declarative","Exclamatory","Interrogative","Imperative"], answerText:"Declarative", explanation:"Simple statement of fact." },
      { sentence: "Identify the sentence type: 'Please lend me your pen.'", chapter:"Types of Sentences", options:["Imperative","Declarative","Exclamatory","Interrogative"], answerText:"Imperative", explanation:"Request." },
      { sentence: "Identify the sentence type: 'What a clever idea!'", chapter:"Types of Sentences", options:["Exclamatory","Declarative","Interrogative","Imperative"], answerText:"Exclamatory", explanation:"Expresses admiration or surprise." },

      /* (‚Ä¶remaining items from your original file continue; they‚Äôre present above already and not needed
          for the fixed 10 selection logic. Keeping the full bank ensures future flexibility.) */
    ];

    /* ============================
   QUIZ STATE (RANDOM 10 QUESTIONS)
   ============================ */

// Function to shuffle the question bank randomly
function shuffleArray(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// Pick 10 random questions each time the quiz starts or refreshes
const RANDOM_TEN = shuffleArray([...bank]).slice(0, 10);
let selected = RANDOM_TEN;
let currentQ = 0;
let score = 0;
let chosenOption = null;
    // Timer
    const SECS_PER_Q = 30;
    let remaining = SECS_PER_Q;
    let ticker = null;

    // PDF answers
    const userAnswers = [];

    // Elements
    const sentenceEl = document.getElementById('sentence');
    const optionsEl = document.getElementById('options');
    const submitBtn = document.getElementById('submitBtn');
    const skipBtn = document.getElementById('skipBtn');
    const nextBtn = document.getElementById('nextBtn');
    const startBtn = document.getElementById('startBtn');
    const restartBtn = document.getElementById('restartBtn');
    const qIndexEl = document.getElementById('qIndex');
    const qTotalEl = document.getElementById('qTotal');
    const progressBar = document.getElementById('progressBar');
    const feedback = document.getElementById('feedback');
    const scoreEl = document.getElementById('currentScore');
    const timerEl = document.getElementById('timer');
    const downloadBtn = document.getElementById('downloadPdfBtn');

    qTotalEl.textContent = selected.length;

    function startGame(){
      currentQ = 0;
      score = 0;
      userAnswers.length = 0;
      scoreEl.textContent = '0';
      downloadBtn.style.display = 'none';
      startBtn.style.display = 'none';
      restartBtn.style.display = 'inline-block';
      loadQuestion();
    }

    function loadQuestion(){
      if(currentQ >= selected.length){ return finishQuiz(); }
      const item = selected[currentQ];

      // UI
      sentenceEl.textContent = item.sentence;
      optionsEl.innerHTML = '';
      chosenOption = null;
      feedback.textContent = '';
      submitBtn.disabled = true;
      skipBtn.disabled = false;
      nextBtn.style.display = 'none';
      optionsEl.setAttribute('aria-hidden','false');

      // build options
      item.options.forEach(opt=>{
        const d = document.createElement('div');
        d.className = 'opt';
        d.textContent = opt;
        d.setAttribute('data-val', opt);
        d.tabIndex = 0;
        d.addEventListener('click', ()=> selectOption(d));
        d.addEventListener('keydown', e=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); selectOption(d); }});
        optionsEl.appendChild(d);
      });

      qIndexEl.textContent = currentQ + 1;
      progressBar.style.width = Math.round((currentQ/selected.length)*100) + '%';

      // timer
      startTimer();
    }

    function selectOption(node){
      optionsEl.querySelectorAll('.opt').forEach(n => n.classList.remove('selected'));
      node.classList.add('selected');
      chosenOption = node.getAttribute('data-val');
      submitBtn.disabled = false;
    }

    function gradeAndLock(reason){
      const item = selected[currentQ];
      const correct = item.answerText;

      // stop timer
      stopTimer();

      // mark options
      optionsEl.querySelectorAll('.opt').forEach(n=>{
        const val = n.getAttribute('data-val');
        n.style.pointerEvents = 'none';
        if(val === correct) n.classList.add('correct');
        if(chosenOption && val === chosenOption && chosenOption !== correct) n.classList.add('wrong');
      });

      // scoring + feedback
      let userAnsText = chosenOption || (reason === 'timeout' ? 'Timed out' : 'Skipped');
      if(chosenOption === correct){
        score++;
        scoreEl.textContent = score;
        feedback.textContent = '‚úÖ Correct! ' + (item.explanation ? ('‚Äî ' + item.explanation) : '');
      }else if(reason === 'timeout'){
        feedback.textContent = `‚è±Ô∏è Time up ‚Äî Correct: "${correct}".` + (item.explanation ? (' ' + item.explanation) : '');
      }else if(reason === 'skip'){
        feedback.textContent = `‚§º Skipped ‚Äî Correct: "${correct}".` + (item.explanation ? (' ' + item.explanation) : '');
      }else{
        feedback.textContent = `‚ùå Wrong ‚Äî Correct: "${correct}".` + (item.explanation ? (' ' + item.explanation) : '');
      }

      // record for PDF
      userAnswers.push({ question: item.sentence, userAnswer: userAnsText, correctAnswer: correct });

      // controls
      submitBtn.disabled = true;
      skipBtn.disabled = true;
      nextBtn.style.display = 'inline-block';

      if(userAnswers.length >= selected.length){
        downloadBtn.style.display = 'inline-block';
      }
    }

    function submitAnswer(){
      if(!chosenOption){
        feedback.textContent = 'Please select an option (or Skip).';
        return;
      }
      gradeAndLock('submit');
    }

    function skipQuestion(){
      chosenOption = null;
      gradeAndLock('skip');
    }

    function nextQuestion(){
      currentQ++;
      if(currentQ < selected.length){
        loadQuestion();
      }else{
        finishQuiz();
      }
    }

    function finishQuiz(){
      stopTimer(true);
      sentenceEl.textContent = `Test Complete ‚Äî your score: ${score} / ${selected.length}`;
      optionsEl.innerHTML = '';
      optionsEl.setAttribute('aria-hidden','true');
      feedback.innerHTML = `<div>Final Score: <strong>${score}/${selected.length}</strong> ‚Äî ${Math.round(score/selected.length*100)}%</div>`;
      progressBar.style.width = '100%';
      submitBtn.disabled = true;
      skipBtn.disabled = true;
      nextBtn.style.display = 'none';
      downloadBtn.style.display = 'inline-block';
    }

    // TIMER
    function startTimer(){
      stopTimer();
      remaining = SECS_PER_Q;
      timerEl.textContent = `‚è≥ ${remaining}s`;
      ticker = setInterval(()=>{
        remaining--;
        timerEl.textContent = `‚è≥ ${remaining}s`;
        if(remaining <= 0){
          clearInterval(ticker); ticker = null;
          chosenOption = null;
          gradeAndLock('timeout');
        }
      }, 1000);
    }
    function stopTimer(hide){
      if(ticker){ clearInterval(ticker); ticker = null; }
      if(hide){ timerEl.textContent = '‚è≥ 0s'; }
    }

    // EVENTS
    document.getElementById('startBtn').addEventListener('click', startGame);
    document.getElementById('restartBtn').addEventListener('click', ()=>{
      startBtn.style.display = 'inline-block';
      restartBtn.style.display = 'none';
      sentenceEl.innerHTML = 'Press <strong>Start Game</strong> to begin the 10 marks test.';
      optionsEl.innerHTML = '';
      feedback.textContent = '';
      score = 0; scoreEl.textContent = 0;
      progressBar.style.width = '0%';
      submitBtn.disabled = true; skipBtn.disabled = true; nextBtn.style.display = 'none';
      stopTimer(true);
      downloadBtn.style.display = 'none';
      currentQ = 0;
    });
    document.getElementById('submitBtn').addEventListener('click', submitAnswer);
    document.getElementById('skipBtn').addEventListener('click', skipQuestion);
    document.getElementById('nextBtn').addEventListener('click', nextQuestion);

    // PDF EXPORT
    document.getElementById("downloadPdfBtn").addEventListener("click", function () {
      if (userAnswers.length === 0) { alert("No answers to download!"); return; }
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      let y = 15;

      doc.setFont("helvetica", "bold");
      doc.setFontSize(14);
      doc.text("My Quiz Answers", 14, y);
      y += 8;

      doc.setFont("helvetica", "normal");
      doc.setFontSize(12);

      userAnswers.forEach((q, i) => {
        const lines = [
          `${i + 1}. ${q.question}`,
          `Your Answer: ${q.userAnswer}`,
          `Correct Answer: ${q.correctAnswer}`
        ];
        lines.forEach(line => {
          const wrapped = doc.splitTextToSize(line, 180); // 180mm width fits A4 margins
doc.text(wrapped, 14, y);
y += wrapped.length * 5; // move down slightly for each wrapped line
if (y > 270) { doc.addPage(); y = 20; }
        });
        y += 4;
      });

      doc.save("My_Quiz_Answers.pdf");
    });
  </script>
</body>
</html>
